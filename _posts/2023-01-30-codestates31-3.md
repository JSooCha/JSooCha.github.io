---
title: ACID
excerpt: 트랜잭션, ACID
categories: DB
tags: [codestates, DB]
toc: true
toc_sticky: true
author_profile: true
sidebar_main: true
published : true
---


## 트랜잭션 (Transaction)
- 데이터베이스 상태를 변화시키기 위한 여러 작업을 하나로 묶은 실행 유닛
- 작업이 하나라도 실패한다면, 트랜잭션에 속한 모든 작업이 실패한 것으로 간주
  - 모든 작업을 성공적으로 완료해야 트랜잭션이 성공한 것 
  - 성공과 실패라는 두 개의 결과만 존재
<br>
- 커밋(commit) : 모든 작업을 성공적으로 수행하면, 해당 작업을 데이터베이스에 반영
- 롤백(rollback) : 작업이 하나라도 실패하면, 이전에 성공한 작업들을 이전 상태로 되돌림

### ACID
데이터베이스 내 트랜잭션의 안전성을 보장하기 위한 성질

#### Atomicity(원자성)
- 트랜잭션 내, 모든 연산은 전부 성공하거나 전부 실패해야 함
  - 하나의 작업이 실패하면, 한 작업 단위로 묶여있는 모든 작업을 실패하게 만들어 기존 데이터 보호
  - e.g. 계좌 이체 시, 출금은 성공했는데 입금은 실패하면 두 작업을 모두 실패하게 하여 금액이 증발되는 것을 방지

#### Consistency(일관성)
- 하나의 트랜잭션 전후에 데이터베이스의 상태는 일관되어야 함 
  - 데이터베이스의 제약, 규칙을 만족
  - e.g. '이름은 null 값이 아니어야 한다'는 제약 조건을 가진 경우, 이름이 없는 데이터를 추가하거나, 기존 이름을 삭제하는 쿼리는 이루어지지 않아야 함

#### Isolation(격리성, 고립성)
- 모든 트랜잭션은 독립적으로 실행되어야 함
  - 여러 개의 트랜잭션이 동시에 실행될 때, 각 트랜잭션은 서로 영향을 주지 않고 연속으로 실행된 것과 동일한 결과를 발생시킴
    - 각 트랜잭션은 서로의 작업 내용을 알 수 없으므로, 실행 중인 트랜잭션의 중간 결과는 다른 트랜잭션이 참조할 수 없음
  - e.g. 10 만원이 있는 계좌에서 계좌 A로 6만원, 계좌 B 로 6만원을 동시에 이체하는 경우, 계좌 A에 먼저 송금하고 계좌 B에 보내는 결과와 동일해야 함
    - 트랜잭션이 동시에 실행된다고 해서 각각 6만원씩 송금하여 마이너스 통장이 되는 것이 아닌, 둘 중 하나의 계좌에서 입금이 취소됨
- 동시성과 대립되는 성질
  - 고립성을 지키기 위해 모든 트랜잭션을 순차적으로 진행하면, 처리 속도가 느려지므로 격리 수준을 나누어 서비스 환경에 따라 격리 수준을 부여해야 함
  - 트랜잭션 고립화 수준(Transaction Isolation Level) 참고
  
#### Durability(영속성, 지속성)
- 성공적으로 수행된 트랜잭션은 로그가 기록되고, 데이터베이스에 영구적으로 보존되어야 함
  - 런타임 오류, 시스템 오류가 발생하더라도, 해당 기록은 영구적
  - 계좌 이체 성공 후, 은행 데이터베이스에 오류가 발생해 종료되더라도 계좌이체 내역은 기록으로 남음
- Atomicity (원자성)
  - 로그 기록 전, 시스템 오류로 종료가 된다면 해당 트랜잭션은 실패로 간주






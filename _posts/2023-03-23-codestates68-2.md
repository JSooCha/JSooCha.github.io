---
title: Hello, OAuth 2 ìƒ˜í”Œ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬í˜„
excerpt: Spring Securityì—ì„œì˜ OAuth2 ì¸ì¦
categories: Spring
tags: [codestates, Spring]
toc: true
toc_sticky: true
author_profile: true
sidebar_main: true
published : true
---

## ì˜ì¡´ì„± ì¶”ê°€
```
dependencies {
	implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
	implementation 'org.springframework.boot:spring-boot-starter-validation'
	implementation 'org.springframework.boot:spring-boot-starter-web'
	implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'    // (1)
	testImplementation 'org.springframework.boot:spring-boot-starter-test'
	implementation 'org.springframework.boot:spring-boot-starter-security'     // (2)
	implementation 'org.springframework.boot:spring-boot-starter-oauth2-client'  // (3)
	compileOnly 'org.projectlombok:lombok'
	runtimeOnly 'com.h2database:h2'
	annotationProcessor 'org.projectlombok:lombok'
	implementation 'org.mapstruct:mapstruct:1.5.2.Final'
	annotationProcessor 'org.mapstruct:mapstruct-processor:1.5.2.Final'
	implementation 'org.springframework.boot:spring-boot-starter-mail'
	implementation 'com.google.code.gson:gson'
}
```
- HTML í™”ë©´ì„ êµ¬ì„±í•˜ê¸° ìœ„í•œ í…œí”Œë¦¿ì¸ íƒ€ì„ë¦¬í”„(Thymeleaf)
- Spring Security ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë¯€ë¡œ spring-boot-starter-security ì¶”ê°€
- êµ¬ê¸€ì˜ OAuth 2 ì‹œìŠ¤í…œì„ ì´ìš©í•˜ëŠ” OAuth 2 í´ë¼ì´ì–¸íŠ¸ì´ë¯€ë¡œ í´ë¼ì´ì–¸íŠ¸ë¡œì¨ì˜ ì—­í• ì„ í•˜ê¸° ìœ„í•´ spring-boot-starter-oauth2-client ì¶”ê°€

## ë³´í˜¸ëœ ì›¹ í˜ì´ì§€
SSR ë°©ì‹ì˜ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ HTMLë¡œ ë Œë”ë§ ë˜ëŠ” í˜ì´ì§€ê°€ ì¡´ì¬

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Welcome to Hello OAuth 2.0</title>
</head>
<body>
    <div style="text-align: center"><h2>Welcome to Hello OAuth 2.0!!</h2></div>
</body>
</html>
```
<div style = "text-align : center">OAuth 2ë¡œ ë³´í˜¸ë˜ëŠ” home-oauth2.html</div><br>

OAuth 2 ì¸ì¦ì„ í†µí•´ ë³´í˜¸ë˜ëŠ” ê°„ë‹¨í•œ HTML í˜ì´ì§€     
OAuth 2ë¡œ ë¡œê·¸ì¸ ì¸ì¦ì— ì„±ê³µí•˜ì§€ ì•Šìœ¼ë©´ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸í•  ìˆ˜ ì—†ìŒ

```
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class HelloHomeController {
    @GetMapping("/hello-oauth2")
    public String home() {
        return "hello-oauth2";
    }
}
```
<div style = "text-align : center">hello-oauth2 í™”ë©´ì— ëŒ€í•œ ë·°ë¥¼ ë¦¬í„´í•˜ëŠ” HelloHomeController</div><br>
SSR(Server Side Rendering) ë°©ì‹ì˜ í•¸ë“¤ëŸ¬(Controller) ë©”ì„œë“œì˜ ë¦¬í„´ íƒ€ì…ì´ Stringì´ë©´ ë·° ì´ë¦„(hello-oauth2)ì„ ë¦¬í„´í•˜ë©°, ìµœì¢…ì ìœ¼ë¡œ hello-oauth2.htmlì„ ì›¹ë¸Œë¼ìš°ì €ë¡œ ì „ì†¡

## OAuth 2 ì¸ì¦ì„ ìœ„í•œ SecurityConfiguration ì„¤ì •

### Spring Bootì˜ ìë™ êµ¬ì„±ì„ ì´ìš©í•œ OAuth 2 ì¸ì¦ ì„¤ì •
```
@Configuration
public class SecurityConfiguration {
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .csrf().disable()
            .formLogin().disable()
            .httpBasic().disable()
            .authorizeHttpRequests(authorize -> authorize    // (1)
                    .anyRequest().authenticated()
            )
            .oauth2Login(withDefaults());    // (2)
        return http.build();
    }
}
```
<div style = "text-align : center">OAuth 2 ë¡œê·¸ì¸ ì„¤ì •ì´ ì¶”ê°€ëœ SecurityConfiguration</div><br>
(1) : ì¸ì¦ëœ requestì— ëŒ€í•´ì„œë§Œ ì ‘ê·¼ì„ í—ˆìš©í•˜ë„ë¡ authorize.anyRequest().authenticated() ì¶”ê°€
(2) : .oauth2Login(withDefaults()) ë¥¼ ì¶”ê°€í•˜ì—¬ OAuth 2 ë¡œê·¸ì¸ ì¸ì¦ í™œì„±í™”

#### OAuth 2 í´ë¼ì´ì–¸íŠ¸ ë“±ë¡ ì •ë³´ ì¶”ê°€
```
spring:
  h2:
    console:
      enabled: true
      path: /h2
  datasource:
    url: jdbc:h2:mem:test
  jpa:
    hibernate:
      ddl-auto: create  
    show-sql: true
    properties:
      hibernate:
        format_sql: true
  sql:
    init:
      data-locations: classpath*:db/h2/data.sql
  security:
    oauth2:
      client:
        registration:
          google:
            clientId: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx           # (1)
            clientSecret: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx  # (2)

...
...
```
<div style = "text-align : center">êµ¬ê¸€ OAuth 2 í´ë¼ì´ì–¸íŠ¸ ë“±ë¡ ì •ë³´ê°€ ì¶”ê°€ëœ application.yml</div><br>

(1) : OAuth 2 í´ë¼ì´ì–¸íŠ¸ ID  
(2) : í´ë¼ì´ì–¸íŠ¸ ë³´ì•ˆ ë¹„ë°€ë²ˆí˜¸(í´ë¼ì´ì–¸íŠ¸ì˜ Secret)

â­ ì‹¤ë¬´ì—ì„œ OAuth 2 í´ë¼ì´ì–¸íŠ¸ IDì™€ Secret ê°™ì€ ë¯¼ê°í•œ ì •ë³´ë¥¼ ì„¤ì •í•œë‹¤ë©´ OSì˜ ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì— ì„¤ì •í•˜ê±°ë‚˜ ë˜ëŠ” application.yml íŒŒì¼ì— êµ¬ì„±í•˜ëŠ” í”„ë¡œí¼í‹° ì •ë³´ë¥¼ ì• í”Œë¦¬ì¼€ì´ì…˜ ì™¸ë¶€ì˜ ì•ˆì „í•œ ê²½ë¡œì— ìœ„ì¹˜ì‹œí‚¤ëŠ” ë“±ì˜ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•´ì•¼ í•¨

#### í…ŒìŠ¤íŠ¸
![1](https://user-images.githubusercontent.com/90169862/227128176-28a9a762-6035-43af-80e6-ea60b7da9772.PNG)

![2](https://user-images.githubusercontent.com/90169862/227130561-78d4ab0b-6d9b-4e93-a84c-9eff18ac9d6c.PNG)

êµ¬ê¸€ ë¡œê·¸ì¸ ì¸ì¦ì— ì„±ê³µí•´ì•¼ ì›¹ ë¸Œë¼ìš°ì € í™”ë©´ì´ í‘œì‹œë¨

### Configurationì„ í†µí•œ OAuth 2 ì¸ì¦ ì„¤ì •
```
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.oauth2.client.CommonOAuth2Provider;
import org.springframework.security.oauth2.client.registration.ClientRegistration;
import org.springframework.security.oauth2.client.registration.ClientRegistrationRepository;
import org.springframework.security.oauth2.client.registration.InMemoryClientRegistrationRepository;
import org.springframework.security.web.SecurityFilterChain;

import static org.springframework.security.config.Customizer.withDefaults;

@Configuration
public class SecurityConfiguration {
    @Value("${spring.security.oauth2.client.registration.google.clientId}")  // (1)
    private String clientId;

    @Value("${spring.security.oauth2.client.registration.google.clientSecret}") // (2)
    private String clientSecret;

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .csrf().disable()
            .formLogin().disable()
            .httpBasic().disable()
            .authorizeHttpRequests(authorize -> authorize
                    .anyRequest().authenticated()
            )
            .oauth2Login(withDefaults());
        return http.build();
    }

    // (3)
    @Bean
    public ClientRegistrationRepository clientRegistrationRepository() {
        var clientRegistration = clientRegistration();    // (3-1)

        return new InMemoryClientRegistrationRepository(clientRegistration);   // (3-2)
    }

    // (4)
    private ClientRegistration clientRegistration() {
        // (4-1)
        return CommonOAuth2Provider
                .GOOGLE
                .getBuilder("google")
                .clientId(clientId)
                .clientSecret(clientSecret)
                .build();
    }
}
```
(1), (2) : application.yml íŒŒì¼ì— ì„¤ì •ë˜ì–´ ìˆëŠ” êµ¬ê¸€ì˜ Client IDì™€ Secret ë¡œë“œ

(3) : ClientRegistrationRepositoryë¥¼ Beanìœ¼ë¡œ ë“±ë¡
  - ClientRegistrationRepository : ClientRegistrationì„ ì €ì¥í•˜ê¸° ìœ„í•œ Responsitory
    - Spring Bootì˜ ìë™ êµ¬ì„± ê¸°ëŠ¥ì„ ì´ìš©í•  ê²½ìš°, application.yml íŒŒì¼ì— ì„¤ì •ëœ êµ¬ê¸€ì˜ Client IDì™€ Secret ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‚´ë¶€ì ìœ¼ë¡œ ClientRegistrationRepository Beanì´ ìƒì„±ë˜ëŠ” ë°˜ë©´, ì—¬ê¸°ì„œëŠ” Configurationì„ í†µí•´ ClientRegistrationRepository Beanì„ ì§ì ‘ ë“±ë¡
  - (3-1) : private ë©”ì„œë“œì¸ clientRegistration()ì„ í˜¸ì¶œí•˜ì—¬ ClientRegistration ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë¦¬í„´ ë°›ìŒ
  - (3-2) : ClientRegistrationRepository ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ í´ë˜ìŠ¤ì¸ InMemoryClientRegistrationRepositoryì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
    - InMemoryClientRegistrationRepository : ClientRegistration ì„ ë©”ëª¨ë¦¬ì— ì €ì¥

(4) : ClientRegistration ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” private ë©”ì„œë“œ
  - ClientRegistration : OAuth 2 Clientì— ëŒ€í•œ ë“±ë¡ ì •ë³´ë¥¼ í‘œí˜„í•˜ëŠ” ê°ì²´
  - (4-1) :  Spring Securityì—ì„œëŠ” CommonOAuth2Providerë¼ëŠ” enumì„ ì œê³µ
    - CommonOAuth2Provider : ë‚´ë¶€ì ìœ¼ë¡œ Builder íŒ¨í„´ì„ ì´ìš©í•´ ClientRegistration ì¸ìŠ¤í„´ìŠ¤ ì œê³µ
    
### ğŸ’¡ Spring Boot ìë™ êµ¬ì„±

##### application.ymlì— Client IDì™€ Client Secretë§Œ ì¶”ê°€í•˜ê³ , SecurityConfiguration í´ë˜ìŠ¤ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´?
ê·¸ë˜ë„ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ êµ¬ê¸€ì˜ ë¡œê·¸ì¸ ì¸ì¦ í™”ë©´ì€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ê³ , OAuth 2 ì¸ì¦ì´ ì •ìƒ ë™ì‘í•œë‹¤.

build.gradle dependences {â€¦}ì— implementation 'org.springframework.boot:spring-boot-starter-oauth2-client' ë¥¼ ì¶”ê°€í•˜ê¸°ë§Œ í•˜ë©´ Spring Bootì˜ ìë™ êµ¬ì„± ê¸°ëŠ¥ìœ¼ë¡œ ë‚´ë¶€ì ìœ¼ë¡œ ì•Œì•„ì„œ OAuth 2ì˜ ê¸°ëŠ¥ì„ í™œì„±í™”í•´ì¤€ë‹¤.

í•˜ì§€ë§Œ ë¬´ì¡°ê±´ì ì¸ ìë™ êµ¬ì„±ë³´ë‹¤ëŠ” ëª…ì‹œì ìœ¼ë¡œ íŠ¹ì • ì„¤ì •ì„ ì„ ì–¸í•´ì„œ ìœ ì§€ë³´ìˆ˜ê°€ ìš©ì´í•˜ê³  ê°€ë…ì„± ìˆëŠ” ì½”ë“œë¥¼ êµ¬ì„±í•˜ëŠ” ê²ƒ ì—­ì‹œ ì¤‘ìš”í•˜ë‹¤.

## ì¸ì¦ëœ Authentication ì •ë³´ í™•ì¸
ì¸ì¦ì´ ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰ë˜ë©´ SecurityContextì— ì¸ì¦ëœ Authenticationì´ ì €ì¥ë¨

### SecurityContext ì´ìš©
```
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.oauth2.core.user.OAuth2User;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class HelloHomeController {
    @GetMapping("/hello-oauth2")
    public String home() {
        var oAuth2User = (OAuth2User)SecurityContextHolder.getContext().getAuthentication().getPrincipal(); // (1)
        System.out.println(oAuth2User.getAttributes().get("email"));   // (2)
        return "hello-oauth2";
    }
}
```
<div style = "text-align : center">ì¸ì¦ëœ ì‚¬ìš©ì ì •ë³´ ì–»ê¸°</div><br>

(1) : SecurityContextì—ì„œ ì¸ì¦ëœ Authentication ê°ì²´ë¥¼ í†µí•´ Principal ê°ì²´ë¥¼ ì–»ìŒ
  - OAuth2ë¡œ ë¡œê·¸ì¸ ì¸ì¦ì„ ìˆ˜í–‰í–ˆìœ¼ë¯€ë¡œ SecurityContextì— ì €ì¥ëœ Principalì€ OAuth2User ê°ì²´ë¡œ ìºìŠ¤íŒ… ê°€ëŠ¥

(2) : OAuth2User ê°ì²´ì— ì €ì¥ë˜ì–´ ìˆëŠ” ì‚¬ìš©ìì˜ ì •ë³´ ì¤‘ì—ì„œ getAttributes() ë©”ì„œë“œë¥¼ í†µí•´ ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì •ë³´ë¥¼ ì–»ìŒ

ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ home() í•¸ë“¤ëŸ¬ ë©”ì„œë“œë¡œ requestë¥¼ ì „ì†¡í•˜ë©´ OAuth 2 ì¸ì¦ì— ì„±ê³µí•˜ê¸° ì „ê¹Œì§€ëŠ” home() í•¸ë“¤ëŸ¬ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì§€ ì•ŠìŒ
ë”°ë¼ì„œ (1)ê³¼ ê°™ì´ SecurityContextì—ì„œ ì¸ì¦ëœ Authenticationì„ ì–»ì€ í›„ì— (2)ì™€ ê°™ì´ ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì¶œë ¥í–ˆì„ ë•Œ, ì •ìƒì ìœ¼ë¡œ ì´ë©”ì¼ ì£¼ì†Œê°€ ì¶œë ¥ëœë‹¤ë©´ OAuth 2 ì¸ì¦ì— ì„±ê³µí–ˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŒ

### Authentication ê°ì²´ë¥¼ í•¸ë“¤ëŸ¬ ë©”ì„œë“œ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ëŠ” ë°©ë²•
```
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.oauth2.client.OAuth2AuthorizedClientService;
import org.springframework.security.oauth2.core.OAuth2AccessToken;
import org.springframework.security.oauth2.core.user.OAuth2User;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class HelloHomeController {
    @GetMapping("/hello-oauth2")
    public String home(Authentication authentication) {    // (1)
        var oAuth2User = (OAuth2User)authentication.getPrincipal();
        System.out.println(oAuth2User);
        System.out.println("User's email in Google: " + oAuth2User.getAttributes().get("email"));

        return "hello-oauth2";
    }
}
```
(1) : ì¸ì¦ëœ Authenctionì„ í•¸ë“¤ëŸ¬ ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ìŒ

### OAuth2Userë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ëŠ” ë°©ë²•
```
import org.springframework.security.core.annotation.AuthenticationPrincipal;
import org.springframework.security.oauth2.core.user.OAuth2User;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class HelloHomeController {
    @GetMapping("/")
    public String home(@AuthenticationPrincipal OAuth2User oAuth2User) {  // (1)
        System.out.println("User's email in Google: " + oAuth2User.getAttributes().get("email"));

        return "hello-oauth2";
    }
}
```
(1) : @AuthenticationPrincipal ì• ë„ˆí…Œì´ì…˜ì„ ì´ìš©í•´ OAuth2User ê°ì²´ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì§ì ‘ ì „ë‹¬ ë°›ìŒ

## Authorization Serverë¡œë¶€í„° ì „ë‹¬ë°›ì€ Access Token í™•ì¸
êµ¬ê¸€ì˜ OAuth 2 ì¸ì¦ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰ë˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ ì„œë²„ì— ì ‘ê·¼í•  ë•Œ ì‚¬ìš©ë˜ëŠ” Access Tokenì„ ì „ë‹¬ë°›ìŒ

### OAuth2AuthorizedClientServiceë¥¼ DI ë°›ëŠ” ë°©ë²•
```
import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.oauth2.client.OAuth2AuthorizedClientService;
import org.springframework.security.oauth2.core.OAuth2AccessToken;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class HelloHomeController {
    private final OAuth2AuthorizedClientService authorizedClientService;

    // (1)
    public HelloHomeController(OAuth2AuthorizedClientService authorizedClientService) {
        this.authorizedClientService = authorizedClientService;
    }

    @GetMapping("/hello-oauth2")
    public String home(Authentication authentication) {
        var authorizedClient = authorizedClientService.loadAuthorizedClient("google", authentication.getName()); // (2)

        // (3)
        OAuth2AccessToken accessToken = authorizedClient.getAccessToken();
        System.out.println("Access Token Value: " + accessToken.getTokenValue());  // (3-1)
        System.out.println("Access Token Type: " + accessToken.getTokenType().getValue());  // (3-2)
        System.out.println("Access Token Scopes: " + accessToken.getScopes());       // (3-3)
        System.out.println("Access Token Issued At: " + accessToken.getIssuedAt());    // (3-4)
        System.out.println("Access Token Expires At: " + accessToken.getExpiresAt());  // (3-5)

        return "hello-oauth2";
    }
}
```
(1) : OAuth2AuthorizedClientService DI 
  - OAuth2AuthorizedClientService : ê¶Œí•œì„ ë¶€ì—¬ë°›ì€ Client(ì´í•˜ OAuth2AuthorizedClient)ë¥¼ ê´€ë¦¬í•˜ëŠ” ì—­í• 
  - OAuth2AuthorizedClientServiceë¥¼ ì´ìš©í•˜ì—¬ OAuth2AuthorizedClient ê°€ ë³´ìœ í•˜ê³  ìˆëŠ” Access Tokenì— ì ‘ê·¼ ê°€ëŠ¥

(2) :  OAuth2AuthorizedClientServiceì˜ loadAuthorizedClient("google", authentication.getName())ë¥¼ ì´ìš©í•´ OAuth2AuthorizedClient ê°ì²´ ë¡œë“œ
  - loadAuthorizedClient()ë¥¼ í˜¸ì¶œí•˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ OAuth2AuthorizedClientRepositoryì—ì„œ OAuth2AuthorizedClient ë¥¼ ì¡°íšŒ

(3) : authorizedClient.getAccessToken()ë¥¼ ì´ìš©í•´ OAuth2AccessToken ê°ì²´ë¥¼ ì–»ìŒ
  - (3-1) : Access Token ë¬¸ìì—´ ì¶œë ¥
  - (3-2) : Token íƒ€ì… ì¶œë ¥
  - (3-3) : í† í°ìœ¼ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë¦¬ì†ŒìŠ¤ì˜ ë²”ìœ„ ëª©ë¡ ì¶œë ¥
  - (3-4) : í† í°ì˜ ë°œí–‰ì¼ì‹œ ì¶œë ¥
  - (3-5) : í† í°ì˜ ë§Œë£Œì¼ì‹œ ì¶œë ¥

ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ í›„, êµ¬ê¸€ ë¡œê·¸ì¸ ì¸ì¦ì— ì„±ê³µí•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ë¡œê·¸ í™•ì¸ ê°€ëŠ¥
```
Access Token Value: ya29.a0Aa4xrXMyh6LZ9Ffg3FTNmvwHQ2yVVNeU_UwnKCJ4-O0P61BbqwioT0-qZ3QzsDfzz_ekCu7w2efS8xL3GjvpU0JjBfBiuWX8s8qa3akuEiLqOjbxSmLn0UVu8fmyp6nvuGUGAqafuVr0sozsh7aOZV3540e8aCgYKATASARISFQEjDvL9eowcbkmqO6nCcuIOn-SxjA0163
Access Token Type: Bearer
Access Token Scopes: [https://www.googleapis.com/auth/userinfo.profile, https://www.googleapis.com/auth/userinfo.email, openid]
Access Token Issued At: 2023-03-23T06:30:55.883356900Z
Access Token Expires At: 2023-03-23T07:30:54.883356900Z
```
<br>

### OAuth2AuthorizedClientë¥¼ í•¸ë“¤ëŸ¬ ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ëŠ” ë°©ë²•
```
import org.springframework.security.oauth2.client.OAuth2AuthorizedClient;
import org.springframework.security.oauth2.client.annotation.RegisteredOAuth2AuthorizedClient;
import org.springframework.security.oauth2.core.OAuth2AccessToken;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class HelloHomeController {
    @GetMapping("/hello-oauth2")
    public String home(@RegisteredOAuth2AuthorizedClient("google") OAuth2AuthorizedClient authorizedClient) { // (1)

        OAuth2AccessToken accessToken = authorizedClient.getAccessToken();
        System.out.println("Access Token Value: " + accessToken.getTokenValue());
        System.out.println("Access Token Type: " + accessToken.getTokenType().getValue());
        System.out.println("Access Token Scopes: " + accessToken.getScopes());
        System.out.println("Access Token Issued At: " + accessToken.getIssuedAt());
        System.out.println("Access Token Expires At: " + accessToken.getExpiresAt());

        return "hello-oauth2";
    }
}
```
(1) : @RegisteredOAuth2AuthorizedClient ì• ë„ˆí…Œì´ì…˜ì„ ì´ìš©í•´ ì•„ì˜ˆ OAuth2AuthorizedClientRepositoryì— ì €ì¥ë˜ì–´ ìˆëŠ” OAuth2AuthorizedClientë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ì•„ì„œ Access Token ì •ë³´ë¥¼ ì–»ìŒ

ğŸ’¡ ìœ„ ë‘ ê°€ì§€ ë°©ë²• ì¤‘ì—ì„œ ì–´ë–¤ ë°©ë²•ì„ ì‚¬ìš©í•´ë„ ìƒê´€ì—†ì§€ë§Œ í•˜ë‚˜ ì´ìƒì˜ í•¸ë“¤ëŸ¬ ë©”ì„œë“œì—ì„œ OAuth2AuthorizedClientë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´ OAuth2AuthorizedClientServiceë¥¼ DI ë°›ì•„ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•´ ë³´ì„
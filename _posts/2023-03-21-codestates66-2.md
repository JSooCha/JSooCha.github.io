---
title: JWT ìê²© ì¦ëª…ì„ ìœ„í•œ ë¡œê·¸ì¸ ì¸ì¦ êµ¬í˜„
excerpt: ë¡œê·¸ì¸ ì¸ì¦ì— ì„±ê³µí•œ ì‚¬ìš©ìì—ê²Œ JWT ìƒì„± ë° ë°œê¸‰
categories: Spring
tags: [codestates, Spring]
toc: true
toc_sticky: true
author_profile: true
sidebar_main: true
published : true
---
## ë¡œê·¸ì¸ ì¸ì¦ íë¦„
1. í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ ì¸¡ì— ë¡œê·¸ì¸ ì¸ì¦ ìš”ì²­(Username/Passwordë¥¼ ì„œë²„ ì¸¡ì— ì „ì†¡)
2. ë¡œê·¸ì¸ ì¸ì¦ì„ ë‹´ë‹¹í•˜ëŠ” Security Filter(JwtAuthenticationFilter)ê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ë¡œê·¸ì¸ ì¸ì¦ ì •ë³´ ìˆ˜ì‹ 
3. Security Filterê°€ ìˆ˜ì‹ í•œ ë¡œê·¸ì¸ ì¸ì¦ ì •ë³´ë¥¼ AuthenticationManagerì—ê²Œ ì „ë‹¬í•´ ì¸ì¦ ì²˜ë¦¬ë¥¼ ìœ„ì„
4. AuthenticationManagerê°€ Custom UserDetailsService(MemberDetailsService)ì—ê²Œ ì‚¬ìš©ìì˜ UserDetails ì¡°íšŒë¥¼ ìœ„ì„
5. Custom UserDetailsService(MemberDetailsService)ê°€ ì‚¬ìš©ìì˜ í¬ë¦¬ë´ì…œì„ DBì—ì„œ ì¡°íšŒí•œ í›„, AuthenticationManagerì—ê²Œ ì‚¬ìš©ìì˜ UserDetailsë¥¼ ì „ë‹¬
6. AuthenticationManagerê°€ ë¡œê·¸ì¸ ì¸ì¦ ì •ë³´ì™€ UserDetailsì˜ ì •ë³´ë¥¼ ë¹„êµí•´ ì¸ì¦ ì²˜ë¦¬
7. JWT ìƒì„± í›„, í´ë¼ì´ì–¸íŠ¸ì˜ ì‘ë‹µìœ¼ë¡œ ì „ë‹¬

(2), (3), (7) : JwtAuthenticationFilter êµ¬í˜„  
(5) : MemberDetailsService êµ¬í˜„  
(4), (6) : Spring Securityì˜ AuthenticationManagerê°€ ëŒ€ì‹  ì²˜ë¦¬


## 1ï¸âƒ£ Custom UserDetailsService êµ¬í˜„
Spring Securityì—ì„œ ì‚¬ìš©ìì˜ ë¡œê·¸ì¸ ì¸ì¦ì„ ì²˜ë¦¬í•˜ëŠ” ê°€ì¥ ë‹¨ìˆœí•˜ê³  íš¨ê³¼ì ì¸ ë°©ë²•ì€ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš©ìì˜ í¬ë¦¬ë´ì…œì„ ì¡°íšŒí•œ í›„, ì¡°íšŒí•œ í¬ë¦¬ë´ì…œì„ AuthenticationManagerì—ê²Œ ì „ë‹¬í•˜ëŠ” Custom UserDetailsServiceë¥¼ êµ¬í˜„í•˜ëŠ” ê²ƒ

### MemberDetailsService

```java
@Component
public class MemberDetailsService implements UserDetailsService {
    private final MemberRepository memberRepository;
    private final CustomAuthorityUtils authorityUtils;

    public MemberDetailsService(MemberRepository memberRepository, CustomAuthorityUtils authorityUtils) {
        this.memberRepository = memberRepository;
        this.authorityUtils = authorityUtils;
    }

    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        Optional<Member> optionalMember = memberRepository.findByEmail(username);
        Member findMember = optionalMember.orElseThrow(() -> new BusinessLogicException(ExceptionCode.MEMBER_NOT_FOUND));

        return new MemberDetails(findMember);
    }

    private final class MemberDetails extends Member implements UserDetails {
        // (1)
        MemberDetails(Member member) {
            setMemberId(member.getMemberId());
            setEmail(member.getEmail());
            setPassword(member.getPassword());
            setRoles(member.getRoles());
        }

        @Override
        public Collection<? extends GrantedAuthority> getAuthorities() {
            return authorityUtils.createAuthorities(this.getRoles());
        }

        @Override
        public String getUsername() {
            return getEmail();
        }

        @Override
        public boolean isAccountNonExpired() {
            return true;
        }

        @Override
        public boolean isAccountNonLocked() {
            return true;
        }

        @Override
        public boolean isCredentialsNonExpired() {
            return true;
        }

        @Override
        public boolean isEnabled() {
            return true;
        }
    }
}
```

## 2ï¸âƒ£ ë¡œê·¸ì¸ ì¸ì¦ ì •ë³´ ì—­ì§ë ¬í™”(Deserialization)ë¥¼ ìœ„í•œ LoginDTO í´ë˜ìŠ¤ 

```java
@Getter
public class LoginDto {
    private String username;
    private String password;
}
```

<div style = "text-align : center">í´ë¼ì´ì–¸íŠ¸ì˜ ì¸ì¦ ì •ë³´ë¥¼ ìˆ˜ì‹ í•  LoginDto</div><br>

## 3ï¸âƒ£ JWTë¥¼ ìƒì„±í•˜ëŠ” JwtTokenizer
ë¡œê·¸ì¸ ì¸ì¦ì— ì„±ê³µí•œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ JWTë¥¼ ìƒì„± ë° ë°œê¸‰í•˜ê³  í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œë§ˆë‹¤ ì „ë‹¬ëœ JWTë¥¼ ê²€ì¦

```java
// (1)
@Component
public class JwtTokenizer {
    @Getter
    @Value("${jwt.key}")
    private String secretKey;       // (2)

    @Getter
    @Value("${jwt.access-token-expiration-minutes}")
    private int accessTokenExpirationMinutes;        // (3)

    @Getter
    @Value("${jwt.refresh-token-expiration-minutes}")
    private int refreshTokenExpirationMinutes;          // (4)

    public String encodeBase64SecretKey(String secretKey) {
        return Encoders.BASE64.encode(secretKey.getBytes(StandardCharsets.UTF_8));
    }

    public String generateAccessToken(Map<String, Object> claims,
                                      String subject,
                                      Date expiration,
                                      String base64EncodedSecretKey) {
        Key key = getKeyFromBase64EncodedKey(base64EncodedSecretKey);

        return Jwts.builder()
                .setClaims(claims)
                .setSubject(subject)
                .setIssuedAt(Calendar.getInstance().getTime())
                .setExpiration(expiration)
                .signWith(key)
                .compact();
    }

    public String generateRefreshToken(String subject, Date expiration, String base64EncodedSecretKey) {
        Key key = getKeyFromBase64EncodedKey(base64EncodedSecretKey);

        return Jwts.builder()
                .setSubject(subject)
                .setIssuedAt(Calendar.getInstance().getTime())
                .setExpiration(expiration)
                .signWith(key)
                .compact();
    }

    public Jws<Claims> getClaims(String jws, String base64EncodedSecretKey) {
        Key key = getKeyFromBase64EncodedKey(base64EncodedSecretKey);

        Jws<Claims> claims = Jwts.parserBuilder()
                .setSigningKey(key)
                .build()
                .parseClaimsJws(jws);
        return claims;
    }

    public void verifySignature(String jws, String base64EncodedSecretKey) {
        Key key = getKeyFromBase64EncodedKey(base64EncodedSecretKey);

        Jwts.parserBuilder()
                .setSigningKey(key)
                .build()
                .parseClaimsJws(jws);
    }

    // (5)
    public Date getTokenExpiration(int expirationMinutes) {
        Calendar calendar = Calendar.getInstance();
        calendar.add(Calendar.MINUTE, expirationMinutes);
        Date expiration = calendar.getTime();

        return expiration;
    }

    private Key getKeyFromBase64EncodedKey(String base64EncodedSecretKey) {
        byte[] keyBytes = Decoders.BASE64.decode(base64EncodedSecretKey);
        Key key = Keys.hmacShaKeyFor(keyBytes);

        return key;
    }
}
```

(1) : JwtTokenizer í´ë˜ìŠ¤ë¥¼ Spring Container(ApplicationContext)ì— Beanìœ¼ë¡œ ë“±ë¡í•˜ê¸° ìœ„í•´ @Component ì• ë„ˆí…Œì´ì…˜ ì¶”ê°€

(2), (3), (4) :  JWT ìƒì„± ì‹œ í•„ìš”í•œ ì •ë³´ 
  - í•´ë‹¹ ì •ë³´ëŠ” application.yml íŒŒì¼ì—ì„œ ë¡œë“œ
  - (2) : JWT ìƒì„± ë° ê²€ì¦ ì‹œ ì‚¬ìš©ë˜ëŠ” Secret Key ì •ë³´
  - (3) : Access Tokenì˜ ë§Œë£Œ ì‹œê°„ ì •ë³´
  - (4) : Refresh Tokenì˜ ë§Œë£Œ ì‹œê°„ ì •ë³´

(5) : getTokenExpiration() - JWTì˜ ë§Œë£Œ ì¼ì‹œë¥¼ ì§€ì •í•˜ê¸° ìœ„í•œ ë©”ì„œë“œë¡œ JWT ìƒì„± ì‹œ ì‚¬ìš©
<br>
 
```yml
...
...

jwt:
  key: ${JWT_SECRET_KEY}               # ë¯¼ê°í•œ ì •ë³´ëŠ” ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì—ì„œ ë¡œë“œí•œë‹¤.
  access-token-expiration-minutes: 30
  refresh-token-expiration-minutes: 420
```
<div style = "text-align : center">JWT ì •ë³´ê°€ í¬í•¨ëœ application.yml</div><br>

- JWTì˜ ì„œëª…ì— ì‚¬ìš©ë˜ëŠ” Secret Key ì •ë³´ëŠ” ë¯¼ê°í•œ(sensitive) ì •ë³´ì´ë¯€ë¡œ ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì˜ ë³€ìˆ˜ë¡œ ë“±ë¡
  - ${JWT_SECRET_KEY} : ë‹¨ìˆœí•œ ë¬¸ìì—´ì´ ì•„ë‹Œ, OSì˜ ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì˜ ê°’ì„ ì½ì–´ì˜¤ëŠ” ì¼ì¢…ì˜ í‘œí˜„ì‹
- access-token-expiration-minutes : Access Tokenì˜ ë§Œë£Œ ì‹œê°„
  - 30ë¶„ìœ¼ë¡œ ì„¤ì •
- refresh-token-expiration-minutesëŠ” Refresh Tokenì˜ ë§Œë£Œ ì‹œê°„
  - 420ë¶„ìœ¼ë¡œ ì„¤ì •

> â­ ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì— ë“±ë¡í•œ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” applicatioin.yml íŒŒì¼ì˜ í”„ë¡œí¼í‹° ëª…ê³¼ ë™ì¼í•œ ë¬¸ìì—´ì„ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ì•¼ í•¨
> - ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì™€ application.ymlì— ì •ì˜í•œ í”„ë¡œí¼í‹° ëª…ì˜ ë¬¸ìì—´ì´ ë™ì¼í•  ê²½ìš° application.yml íŒŒì¼ì— ì •ì˜ëœ í”„ë¡œí¼í‹°ë¥¼ í´ë˜ìŠ¤ì˜ í•„ë“œì—ì„œ ì°¸ì¡°í•  ë•Œ(ì˜ˆ: ${jwt.key.secret}) ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì˜ ê°’ìœ¼ë¡œ ì±„ì›Œì§€ë¯€ë¡œ ê°œë°œìê°€ ì˜ë„í•˜ì§€ ì•Šì€ ê°’ìœ¼ë¡œ ì±„ì›Œì§ˆ ìˆ˜ ìˆìŒ
> - ë”°ë¼ì„œ ê°€ê¸‰ì  ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì˜ ê°’ë„ application.ymlì—ì„œ ë¨¼ì € ë¡œë“œí•œ ë’¤ì— application.ymlì—ì„œ ì¼ê´€ì„± ìˆê²Œ í”„ë¡œí¼í‹° ê°’ì„ ì½ì–´ì˜¤ëŠ” ê²ƒì´ ì¢‹ìŒ
> - ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì— ì •ì˜í•œ ë³€ìˆ˜ëª…ê³¼ application.ymlì— ì •ì˜í•œ í”„ë¡œí¼í‹°ëª…ì˜ ì´ë¦„ì„ ê°ê° ë‹¤ë¥´ê²Œ ì¶”ê°€í•˜ë©´ ë””ë²„ê¹… ì‹œ, application.ymlì—ì„œ ê°’ì„ ë¡œë“œí•˜ëŠ”ì§€ ì‹œìŠ¤í…œ í™˜ê²½ ë³€ìˆ˜ì—ì„œ ê°’ì„ ë¡œë“œí•˜ëŠ”ì§€ ì§ê´€ì ìœ¼ë¡œ ì•Œ ìˆ˜ ìˆìŒ

## 4ï¸âƒ£ ë¡œê·¸ì¸ ì¸ì¦ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” Custom Security Filter êµ¬í˜„
- í´ë¼ì´ì–¸íŠ¸ì˜ ë¡œê·¸ì¸ ì¸ì¦ ì •ë³´ë¥¼ ì§ì ‘ì ìœ¼ë¡œ ìˆ˜ì‹ í•˜ëŠ” ì¸ì¦ ì²˜ë¦¬ì˜ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸(Entrypoint)

```java
public class JwtAuthenticationFilter extends UsernamePasswordAuthenticationFilter {  // (1)
    private final AuthenticationManager authenticationManager;
    private final JwtTokenizer jwtTokenizer;

    // (2)
    public JwtAuthenticationFilter(AuthenticationManager authenticationManager, JwtTokenizer jwtTokenizer) {
        this.authenticationManager = authenticationManager;
        this.jwtTokenizer = jwtTokenizer;
    }

    // (3)
    @SneakyThrows
    @Override
    public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) {

        ObjectMapper objectMapper = new ObjectMapper();    // (3-1)
        LoginDto loginDto = objectMapper.readValue(request.getInputStream(), LoginDto.class); // (3-2)

        // (3-3)
        UsernamePasswordAuthenticationToken authenticationToken =
                                                new UsernamePasswordAuthenticationToken(loginDto.getUsername(), loginDto.getPassword());

        return authenticationManager.authenticate(authenticationToken);  // (3-4)
    }

    // (4)
    @Override
    protected void successfulAuthentication(HttpServletRequest request,
                                            HttpServletResponse response,
                                            FilterChain chain,
                                            Authentication authResult) {
        Member member = (Member) authResult.getPrincipal();  // (4-1)

        String accessToken = delegateAccessToken(member);   // (4-2)
        String refreshToken = delegateRefreshToken(member); // (4-3)

        response.setHeader("Authorization", "Bearer " + accessToken);  // (4-4)
        response.setHeader("Refresh", refreshToken);                   // (4-5)
    }

    // (5)
    private String delegateAccessToken(Member member) {
        Map<String, Object> claims = new HashMap<>();
        claims.put("username", member.getEmail());
        claims.put("roles", member.getRoles());

        String subject = member.getEmail();
        Date expiration = jwtTokenizer.getTokenExpiration(jwtTokenizer.getAccessTokenExpirationMinutes());

        String base64EncodedSecretKey = jwtTokenizer.encodeBase64SecretKey(jwtTokenizer.getSecretKey());

        String accessToken = jwtTokenizer.generateAccessToken(claims, subject, expiration, base64EncodedSecretKey);

        return accessToken;
    }

    // (6)
    private String delegateRefreshToken(Member member) {
        String subject = member.getEmail();
        Date expiration = jwtTokenizer.getTokenExpiration(jwtTokenizer.getRefreshTokenExpirationMinutes());
        String base64EncodedSecretKey = jwtTokenizer.encodeBase64SecretKey(jwtTokenizer.getSecretKey());

        String refreshToken = jwtTokenizer.generateRefreshToken(subject, expiration, base64EncodedSecretKey);

        return refreshToken;
    }
}
```

(1) : UsernamePasswordAuthenticationFilter : í¼ ë¡œê·¸ì¸ ë°©ì‹ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë””í´íŠ¸ Security Filter
  - í¼ ë¡œê·¸ì¸ì´ ì•„ë‹ˆë”ë¼ë„ Username/Password ê¸°ë°˜ì˜ ì¸ì¦ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ UsernamePasswordAuthenticationFilterë¥¼ í™•ì¥í•´ì„œ êµ¬í˜„ ê°€ëŠ¥

(2) : AuthenticationManagerì™€ JwtTokenizer DI
  - AuthenticationManager : ë¡œê·¸ì¸ ì¸ì¦ ì •ë³´(Username/Password)ë¥¼ ì „ë‹¬ë°›ì•„ UserDetailsServiceì™€ ì¸í„°ë™ì…˜ í•œ ë’¤ ì¸ì¦ ì—¬ë¶€ë¥¼ íŒë‹¨
  - JwtTokenizer : í´ë¼ì´ì–¸íŠ¸ê°€ ì¸ì¦ì— ì„±ê³µí•  ê²½ìš°, JWT ìƒì„± ë° ë°œê¸‰

(3) : attemptAuthentication() - ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ ì¸ì¦ì„ ì‹œë„í•˜ëŠ” ë¡œì§ êµ¬í˜„
  - (3-1) : í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì „ì†¡í•œ Usernameê³¼ Passwordë¥¼ DTO í´ë˜ìŠ¤ë¡œ ì—­ì§ë ¬í™”(Deserialization)í•˜ê¸° ìœ„í•´ ObjectMapper ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
  - (3-2) : objectMapper.readValue(request.getInputStream(), LoginDto.class)ë¥¼ í†µí•´ ServletInputStream ì„ LoginDto í´ë˜ìŠ¤ì˜ ê°ì²´ë¡œ ì—­ì§ë ¬í™”(Deserialization)
  - (3-3) : Usernameê³¼ Password ì •ë³´ë¥¼ í¬í•¨í•œ UsernamePasswordAuthenticationToken ìƒì„±
  - (3-4) : UsernamePasswordAuthenticationTokenì„ AuthenticationManagerì—ê²Œ ì „ë‹¬í•˜ë©´ì„œ ì¸ì¦ ì²˜ë¦¬ ìœ„ì„

(4) : successfulAuthentication() - í´ë¼ì´ì–¸íŠ¸ì˜ ì¸ì¦ ì •ë³´ë¥¼ ì´ìš©í•´ ì¸ì¦ì— ì„±ê³µí•  ê²½ìš° í˜¸ì¶œ
  - (4-1) : authResult.getPrincipal()ë¡œ Member ì—”í‹°í‹° í´ë˜ìŠ¤ì˜ ê°ì²´ë¥¼ ì–»ìŒ
    - AuthenticationManager ë‚´ë¶€ì—ì„œ ì¸ì¦ì— ì„±ê³µí•˜ë©´ ì¸ì¦ëœ Authentication ê°ì²´ê°€ ìƒì„±ë˜ë©´ì„œ principal í•„ë“œì— Member ê°ì²´ê°€ í• ë‹¹
  - (4-2) : delegateAccessToken(member) ë©”ì„œë“œë¥¼ ì´ìš©í•´ Access Token ìƒì„±
  - (4-3) : delegateRefreshToken(member) ë©”ì„œë“œë¥¼ ì´ìš©í•´ Refresh Token ìƒì„±
  - (4-4) : response header(Authorization)ì— Access Token ì¶”ê°€ 
    - Access Token : í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ë°±ì—”ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¸¡ì— ìš”ì²­ì„ ë³´ë‚¼ ë•Œë§ˆë‹¤ request headerì— ì¶”ê°€í•´ì„œ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì˜ ìê²©ì„ ì¦ëª…í•˜ëŠ” ë° ì‚¬ìš©
  - (4-5) : response header(Refresh)ì— Refresh Token ì¶”ê°€ 
    - Refresh Token : Access Tokenì´ ë§Œë£Œë  ê²½ìš°, í´ë¼ì´ì–¸íŠ¸ ì¸¡ì´ Access Tokenì„ ìƒˆë¡œ ë°œê¸‰ë°›ê¸° ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì¶”ê°€ì ìœ¼ë¡œ ì œê³µë  ìˆ˜ ìˆìœ¼ë©° Refresh Tokenì„ Access Tokenê³¼ í•¨ê»˜ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì œê³µí• ì§€ ì—¬ë¶€ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ

(5), (6) :  Access Tokenê³¼ Refresh Tokenì„ ìƒì„±í•˜ëŠ” êµ¬ì²´ì ì¸ ë¡œì§

## 5ï¸âƒ£ Custom Filter ì¶”ê°€ë¥¼ ìœ„í•œ SecurityConfiguration ì„¤ì • ì¶”ê°€

```java
@Configuration
public class SecurityConfiguration {
    private final JwtTokenizer jwtTokenizer;

    public SecurityConfiguration(JwtTokenizer jwtTokenizer) {
        this.jwtTokenizer = jwtTokenizer;
    }

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .headers().frameOptions().sameOrigin()
            .and()
            .csrf().disable()
            .cors(withDefaults())
            .formLogin().disable()
            .httpBasic().disable()
            .apply(new CustomFilterConfigurer())   // (1)
            .and()
            .authorizeHttpRequests(authorize -> authorize
                    .anyRequest().permitAll()
            );
        return http.build();
    }

    ...
    ...

    // (2)
    public class CustomFilterConfigurer extends AbstractHttpConfigurer<CustomFilterConfigurer, HttpSecurity> {  // (2-1)
        @Override
        public void configure(HttpSecurity builder) throws Exception {  // (2-2)
            AuthenticationManager authenticationManager = builder.getSharedObject(AuthenticationManager.class);  // (2-3)

            JwtAuthenticationFilter jwtAuthenticationFilter = new JwtAuthenticationFilter(authenticationManager, jwtTokenizer);  // (2-4)
            jwtAuthenticationFilter.setFilterProcessesUrl("/v11/auth/login");          // (2-5)

            builder.addFilter(jwtAuthenticationFilter);  // (2-6)
        }
    }
}
```
<div style = "text-align : center">JwtAuthenticationFilterë¥¼ Spring Security Filter Chainì— ì¶”ê°€í•˜ê¸° ìœ„í•œ SecurityConfiguration ì„¤ì •</div><br>

(1) : apply() ë©”ì„œë“œì— Custom Configurerë¥¼ ì¶”ê°€í•´ ì»¤ìŠ¤í„°ë§ˆì´ì§•(customizations)ëœ Configuration ì¶”ê°€
  - Spring Securityì—ì„œëŠ” ê°œë°œìê°€ ì§ì ‘ Custom Configurerë¥¼ êµ¬ì„±í•´ Spring Securityì˜ Configurationì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•(customizations) ê°€ëŠ¥
  - Custom Configurer : Spring Securityì˜ Configurationì„ ê°œë°œì ì„ì˜ë¡œ ì •ì˜í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥

(2) :  Custom Configurerì¸ CustomFilterConfigurer í´ë˜ìŠ¤
  - JwtAuthenticationFilterë¥¼ ë“±ë¡í•˜ëŠ” ì—­í• 
  - (2-1) : AbstractHttpConfigurerë¥¼ ìƒì†í•´ì„œ Custom Configurer êµ¬í˜„
    - AbstractHttpConfigurer<CustomFilterConfigurer, HttpSecurity>ì™€ ê°™ì´ AbstractHttpConfigurer ë¥¼ ìƒì†í•˜ëŠ” íƒ€ì…ê³¼ HttpSecurityBuilder ë¥¼ ìƒì†í•˜ëŠ” íƒ€ì…ì„ ì œë„ˆë¦­ íƒ€ì…ìœ¼ë¡œ ì§€ì • ê°€ëŠ¥
  - (2-2) : configure()ë¥¼ ì˜¤ë²„ë¼ì´ë“œí•´ì„œ Configurationì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•
  - (2-3) : getSharedObject(AuthenticationManager.class)ë¥¼ í†µí•´ AuthenticationManagerì˜ ê°ì²´ë¥¼ ì–»ìŒ
    - getSharedObject() ë¥¼ í†µí•´ì„œ Spring Securityì˜ ì„¤ì •ì„ êµ¬ì„±í•˜ëŠ” SecurityConfigurer ê°„ì— ê³µìœ ë˜ëŠ” ê°ì²´ë¥¼ ì–»ì„ ìˆ˜ ìˆìŒ
  - (2-4) : JwtAuthenticationFilterë¥¼ ìƒì„±í•˜ë©´ì„œ JwtAuthenticationFilterì—ì„œ ì‚¬ìš©ë˜ëŠ” AuthenticationManagerì™€ JwtTokenizerë¥¼ DI
  - (2-5) : setFilterProcessesUrl() ë©”ì„œë“œë¥¼ í†µí•´ ë””í´íŠ¸ request URLì¸ â€œ/loginâ€ì„ â€œ/v11/auth/loginâ€ìœ¼ë¡œ ë³€ê²½
  - (2-6) : addFilter() ë©”ì„œë“œë¥¼ í†µí•´ JwtAuthenticationFilterë¥¼ Spring Security Filter Chainì— ì¶”ê°€

## ë¡œê·¸ì¸ ì¸ì¦ í…ŒìŠ¤íŠ¸
JwtAuthenticationFilterë¥¼ SecurityConfigurationì— ì¶”ê°€í–ˆìœ¼ë‹ˆ ë¡œê·¸ì¸ ì¸ì¦ ì‹œ, JWT í† í°ì´ responseë¡œ ì˜ ì „ë‹¬ë˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸

##### 1ï¸âƒ£ íšŒì› ê°€ì… ìš”ì²­
 Postmanì—ì„œ íšŒì› ê°€ì… requestë¥¼ ì „ì†¡í•´ì„œ íšŒì› ê°€ì…
 
##### 2ï¸âƒ£ ë¡œê·¸ì¸ ì¸ì¦ ìš”ì²­
íšŒì› ê°€ì… request ì „ì†¡ ì‹œ ì…ë ¥í•œ ì´ë©”ì¼ ì£¼ì†Œì™€ íŒ¨ìŠ¤ì›Œë“œë¡œ ë¡œê·¸ì¸ ì¸ì¦ request ì „ì†¡
  - SecurityConfigurationì—ì„œ ë³€ê²½í•œ URL(/v11/auth/login)ë¡œ ë¡œê·¸ì¸ ì¸ì¦ requestë¥¼ ì „ì†¡

ë¡œê·¸ì¸ ì¸ì¦ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜í–‰ë˜ë©´ Headers íƒ­ì—ì„œ Authorization í‚¤ì˜ ê°’ìœ¼ë¡œ Access Tokenì´, Refresh í‚¤ì˜ ê°’ìœ¼ë¡œ Refresh Tokenì´ í¬í•¨ë¨
  - í´ë¼ì´ì–¸íŠ¸ ìª½ì—ì„œëŠ” ì„œë²„ ì¸¡ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ requestë¥¼ ì „ì†¡í•  ë•Œë§ˆë‹¤ ì „ë‹¬ë°›ì€ JWTë¥¼ request headerì— í¬í•¨ í›„, í´ë¼ì´ì–¸íŠ¸ì˜ ìê²© ì¦ëª… ì •ë³´ë¡œ ì‚¬ìš©

## ë¡œê·¸ì¸ ì¸ì¦ ì„±ê³µ ë° ì‹¤íŒ¨ì— ë”°ë¥¸ ì¶”ê°€ ì²˜ë¦¬
Spring Securityì—ì„œëŠ” Username/Password ê¸°ë°˜ì˜ ë¡œê·¸ì¸ ì¸ì¦ì— ì„±ê³µí–ˆì„ ë•Œ, ë¡œê·¸ë¥¼ ê¸°ë¡í•œë‹¤ê±°ë‚˜ ë¡œê·¸ì¸ì— ì„±ê³µí•œ ì‚¬ìš©ì ì •ë³´ë¥¼ responseë¡œ ì „ì†¡í•˜ëŠ” ë“±ì˜ ì¶”ê°€ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆëŠ” í•¸ë“¤ëŸ¬(AuthenticationSuccessHandler)ì™€ ë¡œê·¸ì¸ ì¸ì¦ ì‹¤íŒ¨ ì‹œ, ì¸ì¦ ì‹¤íŒ¨ì— ëŒ€í•´ ì¶”ê°€ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆëŠ” í•¸ë“¤ëŸ¬(AuthenticationFailureHandler) ì§€ì›

### 1ï¸âƒ£ AuthenticationSuccessHandler êµ¬í˜„

```java
@Slf4j
public class MemberAuthenticationSuccessHandler implements AuthenticationSuccessHandler {  // (1)
    // (2)
    @Override
    public void onAuthenticationSuccess(HttpServletRequest request,
                                        HttpServletResponse response,
                                        Authentication authentication) throws IOException {
        // ì¸ì¦ ì„±ê³µ í›„, ë¡œê·¸ë¥¼ ê¸°ë¡í•˜ê±°ë‚˜ ì‚¬ìš©ì ì •ë³´ë¥¼ responseë¡œ ì „ì†¡í•˜ëŠ” ë“±ì˜ ì¶”ê°€ ì‘ì—…ì„ í•  ìˆ˜ ìˆë‹¤.
        log.info("# Authenticated successfully!");
    }
}
```
<div style = "text-align : center">ë¡œê·¸ì¸ ì¸ì¦ ì„±ê³µ ì‹œ ì¶”ê°€ ì‘ì—…ì„ í•  ìˆ˜ ìˆëŠ” MemberAuthenticationSuccessHandler</div><br>

- Custom AuthenticationSuccessHandlerëŠ”  AuthenticationSuccessHandler ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•¨
- AuthenticationSuccessHandler ì¸í„°í˜ì´ìŠ¤ì—ëŠ” onAuthenticationSuccess() ì¶”ìƒ ë©”ì„œë“œê°€ ì •ì˜ë˜ì–´ ìˆìœ¼ë©°, onAuthenticationSuccess() ë©”ì„œë“œë¥¼ êµ¬í˜„í•˜ì—¬ ì¶”ê°€ ì²˜ë¦¬ ê°€ëŠ¥
  - Authentication ê°ì²´ì— ì‚¬ìš©ì ì •ë³´ë¥¼ ì–»ì€ í›„, HttpServletResponseë¡œ ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ì„ ìƒì„±í•˜ì—¬ response ì „ì†¡

### 2ï¸âƒ£ AuthenticationFailureHandler êµ¬í˜„

```java
@Slf4j
public class MemberAuthenticationFailureHandler implements AuthenticationFailureHandler {  // (1)
    @Override
    public void onAuthenticationFailure(HttpServletRequest request,
                                        HttpServletResponse response,
                                        AuthenticationException exception) throws IOException {
        // ì¸ì¦ ì‹¤íŒ¨ ì‹œ, ì—ëŸ¬ ë¡œê·¸ë¥¼ ê¸°ë¡í•˜ê±°ë‚˜ error responseë¥¼ ì „ì†¡í•  ìˆ˜ ìˆë‹¤.
        log.error("# Authentication failed: {}", exception.getMessage());

        sendErrorResponse(response);  // (2)
    }
    
    private void sendErrorResponse(HttpServletResponse response) throws IOException {
        Gson gson = new Gson();     // (2-1)
        ErrorResponse errorResponse = ErrorResponse.of(HttpStatus.UNAUTHORIZED); // (2-2)
        response.setContentType(MediaType.APPLICATION_JSON_VALUE);    // (2-3)
        response.setStatus(HttpStatus.UNAUTHORIZED.value());          // (2-4)
        response.getWriter().write(gson.toJson(errorResponse, ErrorResponse.class));   // (2-5)
    }
}
```
<div style = "text-align : center">ë¡œê·¸ì¸ ì¸ì¦ ì‹¤íŒ¨ ì‹œ, ì¶”ê°€ ì‘ì—…ì„ í•  ìˆ˜ ìˆëŠ” MemberAuthenticationFailureHandler</div><br>

- Custom AuthenticationFailureHandlerëŠ” AuthenticationFailureHandler ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•¨
- AuthenticationSuccessHandler ì¸í„°í˜ì´ìŠ¤ì—ëŠ” onAuthenticationFailure() ì¶”ìƒ ë©”ì„œë“œê°€ ì •ì˜ë˜ì–´ ìˆìœ¼ë©°, onAuthenticationFailure() ë©”ì„œë“œë¥¼ êµ¬í˜„í•˜ì—¬ ì¶”ê°€ ì²˜ë¦¬
- (2) :  sendErrorResponse() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ì— Error ì •ë³´ë¥¼ ë‹´ê³  ìˆìŒ
  - (2-1) : Error ì •ë³´ê°€ ë‹´ê¸´ ê°ì²´(ErrorResponse)ë¥¼ JSON ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ëŠ”ë° ì‚¬ìš©ë˜ëŠ” Gson ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
  - (2-2) : ErrorResponse ê°ì²´ ìƒì„± í›„, ErrorResponse.of() ë©”ì„œë“œë¡œ HttpStatus.UNAUTHORIZED ìƒíƒœ ì½”ë“œë¥¼ ì „ë‹¬
    - HttpStatus.UNAUTHORIZED(401) : ì¸ì¦ì— ì‹¤íŒ¨í•  ê²½ìš° ì „ë‹¬í•  ìˆ˜ ìˆëŠ” HTTP status
  - (2-3) : responseì˜ Content Typeì´ â€œapplication/jsonâ€ ì´ë¼ëŠ” ê²ƒì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì•Œë ¤ì¤„ ìˆ˜ ìˆë„ë¡ MediaType.APPLICATION_JSON_VALUEë¥¼ HTTP Headerì— ì¶”ê°€
  - (2-4) : responseì˜ statusê°€ 401ì„ì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì•Œë ¤ì¤„ ìˆ˜ ìˆë„ë¡ HttpStatus.UNAUTHORIZED.value()ì„ HTTP Headerì— ì¶”ê°€
  - (2-5) : Gsonì„ ì´ìš©í•´ ErrorResponse ê°ì²´ë¥¼ JSON í¬ë§· ë¬¸ìì—´ë¡œ ë³€í™˜ í›„, ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ ìƒì„±

### 3ï¸âƒ£ AuthenticationSuccessHandler ì™€ AuthenticationFailureHandler ì¶”ê°€
AuthenticationSuccessHandler ì¸í„°í˜ì´ìŠ¤ì™€ AuthenticationFailureHandler ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ JwtAuthenticationFilter ì— ë“±ë¡í•˜ë©´ ë¡œê·¸ì¸ ì¸ì¦ ì‹œ, ë‘ í•¸ë“¤ëŸ¬ë¥¼ ì‚¬ìš© ê°€ëŠ¥

```java
@Configuration
public class SecurityConfiguration {
    private final JwtTokenizer jwtTokenizer;
   
    public SecurityConfiguration(JwtTokenizer jwtTokenizer) {
        this.jwtTokenizer = jwtTokenizer;
    }

    ...
    ...

    public class CustomFilterConfigurer extends AbstractHttpConfigurer<CustomFilterConfigurer, HttpSecurity> {
        @Override
        public void configure(HttpSecurity builder) throws Exception {
            AuthenticationManager authenticationManager = builder.getSharedObject(AuthenticationManager.class);

            JwtAuthenticationFilter jwtAuthenticationFilter = new JwtAuthenticationFilter(authenticationManager, jwtTokenizer);
            jwtAuthenticationFilter.setFilterProcessesUrl("/v11/auth/login");
            jwtAuthenticationFilter.setAuthenticationSuccessHandler(new MemberAuthenticationSuccessHandler());  // (3) ì¶”ê°€
            jwtAuthenticationFilter.setAuthenticationFailureHandler(new MemberAuthenticationFailureHandler());  // (4) ì¶”ê°€
            builder.addFilter(jwtAuthenticationFilter);
        }
    }
}
```
(3), (4) : AuthenticationSuccessHandlerì™€ AuthenticationFailureHandlerë¥¼ JwtAuthenticationFilterì— ë“±ë¡ 

> ##### ğŸ’¡ Springì—ì„œëŠ” ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ new í‚¤ì›Œë“œ ì‚¬ìš©ì„ ìì œí•˜ë¼ê³  í–ˆëŠ”ë° newë¥¼ ì‚¬ìš©í–ˆìŒ
> AuthenticationSuccessHandlerì™€ AuthenticationFailureHandler ì¸í„°í˜ì´ìŠ¤ì˜ êµ¬í˜„ í´ë˜ìŠ¤ê°€ ë‹¤ë¥¸ Security Filterì—ì„œ ì‚¬ìš©ì´ ëœë‹¤ë©´ ApplicationContextì— Beanìœ¼ë¡œ ë“±ë¡í•´ì„œ DI ë°›ëŠ” ê²Œ ë§ìŒ
> í•˜ì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ ì¸ì¦ì„ ìœ„í•œ Security Filterë§ˆë‹¤ AuthenticationSuccessHandlerì™€ AuthenticationFailureHandlerì˜ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ê°ê° ìƒì„±í•  ê²ƒì´ë¯€ë¡œ new í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ì„œ ê°ì²´ë¥¼ ìƒì„±í•´ë„ ë¬´ë°©

### 4ï¸âƒ£ AuthenticationSuccessHandler í˜¸ì¶œ
jwtAuthenticationFilterì—ì„œ í•´ë‹¹ í•¸ë“¤ëŸ¬ì˜ êµ¬í˜„ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ì„œ ì‚¬ìš©

```java
public class JwtAuthenticationFilter extends UsernamePasswordAuthenticationFilter {
    ...
    ...
    
    @Override
    protected void successfulAuthentication(HttpServletRequest request,
                                            HttpServletResponse response,
                                            FilterChain chain,
                                            Authentication authResult) throws ServletException, IOException {
        Member member = (Member) authResult.getPrincipal();

        String accessToken = delegateAccessToken(member);
        String refreshToken = delegateRefreshToken(member);

        response.setHeader("Authorization", "Bearer " + accessToken);
        response.setHeader("Refresh", refreshToken);

        this.getSuccessHandler().onAuthenticationSuccess(request, response, authResult);  // (1) ì¶”ê°€
    }

    ...
    ...
}
```

(1) : ë¡œê·¸ì¸ ì¸ì¦ì— ì„±ê³µí•˜ê³ , JWTë¥¼ ìƒì„±í•´ì„œ response headerì— ì¶”ê°€í•œ ë’¤,AuthenticationSuccessHandlerì˜ onAuthenticationSuccess() ë©”ì„œë“œ í˜¸ì¶œ
  - onAuthenticationSuccess() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ì•ì—ì„œ êµ¬í˜„í•œ MemberAuthenticationSuccessHandlerì˜ onAuthenticationSuccess() ë©”ì„œë“œê°€ í˜¸ì¶œë¨
  - AuthenticationFailureHandlerëŠ” ë³„ë„ì˜ ì½”ë“œë¥¼ ì¶”ê°€í•˜ì§€ ì•Šì•„ë„ ë¡œê·¸ì¸ ì¸ì¦ì— ì‹¤íŒ¨í•˜ë©´ ì•ì„œ êµ¬í˜„í•œ MemberAuthenticationFailureHandlerì˜ onAuthenticationFailure() ë©”ì„œë“œê°€ ì•Œì•„ì„œ í˜¸ì¶œë¨

### í…ŒìŠ¤íŠ¸

- ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë‹¤ì‹œ ì‹¤í–‰í•œ ë’¤ íšŒì› ê°€ì…ì— ì „ì†¡í–ˆë˜ ì´ë©”ì¼ ì£¼ì†Œì™€ íŒ¨ìŠ¤ì›Œë“œë¡œ ë¡œê·¸ì¸ ì¸ì¦ì„ ìœ„í•œ request(localhost:8080/v11/auth/login) ì „ì†¡
  - AuthenticationSuccessHandlerê°€ ì •ìƒ ë™ì‘í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ì€ ë¡œê·¸ ì¶œë ¥
    ```
    2023-03-21 14:23:16.363  INFO 10948 --- [nio-8080-exec-4] c.a.h.MemberAuthenticationSuccessHandler : # Authenticated successfully!
    ```
- ë¡œê·¸ì¸ ì¸ì¦ íŒ¨ìŠ¤ì›Œë“œë¥¼ ë‹¤ë¥´ê²Œ í•´ì„œ ë¡œê·¸ì¸ ì¸ì¦ request ì „ì†¡
  - AuthenticationFailureHandlerê°€ ì •ìƒ ë™ì‘í•œë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ response body í™•ì¸ ê°€ëŠ¥
    ```
    {
        "status": 401,
        "message": "Unauthorized"
    }
    ```

> ë¡œê·¸ì¸ ì¸ì¦ ê¸°ëŠ¥ì€ ë°˜ë“œì‹œ UsernamePasswordAuthenticationFilterë§Œ ì´ìš©í•´ì•¼ ë˜ëŠ” ê²ƒì€ ì•„ë‹˜
> ì˜ˆë¥¼ ë“¤ì–´ OncePerRequestFilter ê°™ì€ Filterë¥¼ ì´ìš©í•´ì„œ êµ¬í˜„í•  ìˆ˜ë„ ìˆìœ¼ë©°, Controllerì—ì„œ API ì—”ë“œí¬ì¸íŠ¸ë¡œ êµ¬í˜„í•˜ëŠ” ë°©ë²•ë„ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„
> ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ì˜ ìš”êµ¬ ì‚¬í•­ì— ì ì ˆí•œ ë°©ë²•ì„ ì„ íƒí•´ì„œ êµ¬í˜„í•  ìˆ˜ ìˆìŒ


### í•µì‹¬ í¬ì¸íŠ¸
- UsernamePasswordAuthenticationFilterë¥¼ ì´ìš©í•´ì„œ JWT ë°œê¸‰ ì „ì˜ ë¡œê·¸ì¸ ì¸ì¦ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
- Spring Securityì—ì„œëŠ” ê°œë°œìê°€ ì§ì ‘ Custom Configurerë¥¼ êµ¬ì„±í•´ Spring Securityì˜ Configurationì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•(customizations) í•  ìˆ˜ ìˆë‹¤.
- Username/Password ê¸°ë°˜ì˜ ë¡œê·¸ì¸ ì¸ì¦ì€ OncePerRequestFilter ê°™ì€ Spring Securityì—ì„œ ì§€ì›í•˜ëŠ” ë‹¤ë¥¸ Filterë¥¼ ì´ìš©í•´ì„œ êµ¬í˜„í•  ìˆ˜ ìˆìœ¼ë©°, Controllerì—ì„œ REST API ì—”ë“œí¬ì¸íŠ¸ë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤.
- Spring Securityì—ì„œëŠ” Username/Password ê¸°ë°˜ì˜ ë¡œê·¸ì¸ ì¸ì¦ì— ì„±ê³µí–ˆì„ ë•Œ, ë¡œê·¸ë¥¼ ê¸°ë¡í•˜ê±°ë‚˜ ë¡œê·¸ì¸ì— ì„±ê³µí•œ ì‚¬ìš©ì ì •ë³´ë¥¼ responseë¡œ ì „ì†¡í•˜ëŠ” ë“±ì˜ ì¶”ê°€ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆëŠ” AuthenticationSuccessHandlerë¥¼ ì§€ì›í•˜ë©°, ë¡œê·¸ì¸ ì¸ì¦ ì‹¤íŒ¨ ì‹œì—ë„ ë§ˆì°¬ê°€ì§€ë¡œ ì¸ì¦ ì‹¤íŒ¨ì— ëŒ€í•´ ì¶”ê°€ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆëŠ” AuthenticationFailureHandlerë¥¼ ì§€ì›í•œë‹¤.


### ì‹¬í™” í•™ìŠµ
- OncePerRequestFilter 
  - https://www.baeldung.com/spring-onceperrequestfilter
  - https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/filter/OncePerRequestFilter.html
- AuthenticationSuccessHandler : https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/web/authentication/AuthenticationSuccessHandler.html
- AuthenticationFailureHandler : https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/web/authentication/AuthenticationFailureHandler.html



